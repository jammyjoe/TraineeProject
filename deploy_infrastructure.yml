parameters:
  - name: Environment
    type: string

steps:
- task: PowerShell@2
  name: Deployment
  displayName: "Deploy Terraform Resources"
  inputs:
    targetType: filePath
    filePath: '$(Build.SourcesDirectory)/Deployment/terraform_deploy.ps1'
    arguments: '-deploymentEnvironment ${{parameters.Environment}}'
  env:
    TF_VAR_SUBSCRIPTION_ID: $(SubscriptionId)
    TF_VAR_CLIENT_ID: $(ClientId)
    TF_VAR_TENANT_ID: $(TenantId)
    TF_VAR_CLIENT_SECRET: $(ClientSecret)


